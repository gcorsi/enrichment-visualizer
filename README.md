# enrichment-visualizer
This repository contains the python script "make_dotplot.py" that can be used to produce a dot plot describing the gene/protein functional enrichment results 
produced by the Cytoscape app "<b>stringApp</b>" (available at: http://apps.cytoscape.org/apps/stringapp).
The code can also handle data generated by other tools, as long as a table with the required columns is given and options are set accordingly.
</br>


<h3>Requirements</h3>
make_dotplot.py requires python v.3, pandas, matplotlib and seaborn. The following versions of these modules were used for testing: </br>
python=3.8.3</br>
matplotlib=3.2.1</br>
pandas=1.0.4</br>
seaborn=0.10.1</br>
</br>


<h3>Usage</h3>
The simplest way of running the script given a stringApp output table is to type:
</br></br>
<code>./make_dotplot.py -e <i>table_enrichment.tsv</i> -o <i>path_to_output_folder</i></code>
</br></br>
where:</br>
<i>table_enrichment.tsv</i> is the stringApp output <i>.tsv</i> table</br>
<i>path_to_output_folder</i> is the path to the folder where the output will be placed (if not-existing, it will be created).
</br></br>
One plot in <i>.svg</i> format for each annotation cathegory (KEGG Pathways, Gene Ontology Components...) will be generated. 
By default, KEGG Pathways and Reactome Pathways are grouped together. To change this behavior set the option --groups to an empty list. </br>
The script automatically adjustes the size of the images based on the number or terms and the length of the terms definitions (eg. pathways names).
In case the automatic adjustment is not sufficient the options --increase_height and/or --increase_width can be used (set an integer > 0). 
</br>


<h3>Running on enrichment results other than stringApp output table </h3>
As a minimum, the table containing the enrichment resuls should contain columns with the following data for each row (ech row represents a term being tested for enrichment):
<ul>
<li> N. background elements (eg. genes)</li>
<li> N. elements assigned to the term</li>
<li> Cathegory name (to group the results based on a certain cathegory. Use one cathegory for all rows to avoid grouping)</li>
<li> Term description</li>
<li> FDR</li>
<ul>
</br>
A name to each of these columns must be given in the header and assigned to the corresponding options (-cn, -c_nb, -c_c, -c_d, -c_f).
 </br>
 
 
<h3>List of all options</h3>
<ul>
  <li>-h, --help</br>show the help message and exit</li>
  <li>-e ENRICHMENT_RESULTS, --enrichment_results ENRICHMENT_RESULTS</br>Path to table with enrichment results, in csv format</li>
  <li>-o O </br>Path to output folder<</li>
  <li>--GSEA {StringApp,Other} </br>Source of the GSEA analysis</li>
  <li>-c_n C_N  </br>Name of the column containing the number of background genes</li>
  <li>-c_nb C_NB </br> Name of the column containing the number of genes assigned to each term</li>
  <li>-c_c C_C   </br> Name of the column containing a category, used to group enriched terms</li>
  <li>-c_d C_D  </br> Name of the column containing the term description </li>
  <li>-c_f C_F   </br> Name of the column containing the FDR value</li>
  <li>-n N    </br> Maximum number of terms to plot</li>
  <li>--ratio_min RATIO_MIN </br> Consider only terms for which the gene-ratio term is above the given threshold</li>
  <li>--palette PALETTE </br>     Color palette used </li>
  <li>--n_bins {2,3,4} </br>     Number of bins for grouping gene counts </li>
  <li>--groups GROUPS [GROUPS ...] </br> List of categories to be grouped together </li>
  <li>--increase_height INCREASE_HEIGHT </br> Integer, increases the height of the plot </li>
  <li>--increase_width INCREASE_WIDTH </br> Integer, increases the width of the plot </li>
</ul>

<h3>Author</h3>
<b>Giulia I. Corsi</b>
giulia at rth dot dk

<h3>Author</h3>
Copyright Â© 2020 Giulia I. Corsi, code released under the the GNU public license version 3 or later.
